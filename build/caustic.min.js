/*!
 * EventEmitter
 * Copyright (c) 2011 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 *//**
 * EventEmitter.
 */function View(a){if(!(this instanceof View))return new View(a);EventEmitter.call(this);var b;~a.indexOf("<")?b=a:b=$("#"+a+"-template").html(),this.el=$(b),this.visit(this.el)}function callback(a){return"string"==typeof a?function(b){return b[a]()}:a}function EventEmitter(){this.callbacks={}}EventEmitter.prototype.on=function(a,b){(this.callbacks[a]=this.callbacks[a]||[]).push(b);return this},EventEmitter.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),c=this.callbacks[a];if(c)for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b);return this},View.prototype.__proto__=EventEmitter.prototype,View.prototype.visit=function(a,b){var c=this,d=a.get(0).nodeName,e=a.attr("class").split(/ +/),f="visit"+d;this[f]&&!b&&this[f](a,e[0]),a.children().each(function(a,b){c.visit($(b))})},View.prototype.visitINPUT=function(a){var b=this,c=a.attr("name"),d=a.attr("type");switch(d){case"text":this[c]=function(b){if(0==arguments.length)return a.val();a.val(b);return this},this[c].isEmpty=function(){return""==a.val()},this[c].clear=function(){a.val("");return b};break;case"checkbox":this[c]=function(c){if(0==arguments.length)return a.attr("checked");switch(typeof c){case"function":a.change(function(d){c.call(b,a.attr("checked"),d)});break;default:a.attr("checked",c?"checked":c)}return this}}},View.prototype.visitFORM=function(a,b){var c=this;this.submit=function(b){switch(typeof b){case"function":a.submit(function(d){b.call(c,d,a);return!1})}}},View.prototype.visitA=function(a,b){var c=this;a.click(function(d){c.emit(b,d,a)}),this[b]=function(b){a.click(function(d){b.call(c,d,a);return!1});return this}},View.prototype.visitP=View.prototype.visitTD=View.prototype.visitSPAN=View.prototype.visitDIV=function(a,b){var c=this;this[b]=function(b){if(0==arguments.length)return a;a.empty().append(b.el||b);return this}},View.prototype.visitUL=function(a,b){var c=this;this.children=[],this[b]={add:function(b){var d=$("<li>");c.children.push(b),a.append(d.append(b.el||b));return this},items:function(){return c.children},length:function(){return this.items().length},each:function(a){for(var b=0,d=c.children.length;b<d;++b)a(c.children[b],b);return this},map:function(a){var b=[],a=callback(a);for(var d=0,e=c.children.length;d<e;++d)b.push(a(c.children[d],d));return b}}},View.prototype.visitH1=View.prototype.visitH2=View.prototype.visitH3=View.prototype.visitH4=View.prototype.visitH5=function(a,b){var c=this;this[b]=function(b){if(0==arguments.length)return a.text();a.text(b.el||b);return this}},View.prototype.remove=function(){var a=this.el.parent(),b=a.get(0).nodeName;"LI"==b?a.remove():this.el.remove();return this},View.prototype.appendTo=function(a){this.el.appendTo(a.el||a);return this}